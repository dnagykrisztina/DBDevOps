<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
<title>ps_thread_stack</title>
<script src="../../../../../scripts/jquery-1.12.0.min.js" type="text/javascript"></script>
<script src="../../../../../scripts/bootstrap.min.js" type="text/javascript"></script>
<script src="../../../../../scripts/clipboard.min.js" type="text/javascript"></script>
<script src="../../../../../scripts/main.js" type="text/javascript"></script>
<link rel="stylesheet" href="../../../../../styles/bootstrap/Default Dark.css" type="text/css">
<link rel="stylesheet" href="../../../../../styles/main.css" type="text/css">
</head>
<body class="watermark">

  <div class="page-wrap">
    <div class="header">
      <div class="row">
        <div class="col-xs-12">
          <ol class="breadcrumb">
            <li><a href="../../../../../startpage.html" data-mapping-enabled="true">Project</a></li>
            <li><a href="../../../../../Servers\Servers.html" data-mapping-enabled="true">Servers</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Cars.localhost.html" data-mapping-enabled="true">Cars.localhost</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Databases\Databases.html" data-mapping-enabled="true">Databases</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Databases\sys\sys.html" data-mapping-enabled="true">sys</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Databases\sys\Functions\Functions.html" data-mapping-enabled="true">Functions</a></li>
            <li class="active">ps_thread_stack</li>
          </ol>
        </div>
      </div>
      <div class="row">
        <div class="title col-xs-12">
          <div><img class="inline-middle image-large" src="../../../../../images/Dark\function.svg" title="ps_thread_stack" />
            <h1 class="inline-middle">ps_thread_stack</h1>
            <div class="dropdown actions-btn-wrap">
              <button type="button" class="btn btn-default actions-btn" data-toggle="dropdown"><span class="icon-actions icon-small actions-btn-span"></span></button>
              <ul class="dropdown-menu dropdown-menu-right">
                <li><a id="CollapseAll" href="#">Collapse All</a></li>
                <li><a id="ExpandAll" href="#">Expand All</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="content">
      <div id="Description" class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">Description</h2>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <span><br />Description<br />-----------<br /><br />Outputs a JSON formatted stack of all statements, stages and events<br />within Performance Schema for the specified thread.<br /><br />Parameters<br />-----------<br /><br />thd_id (BIGINT UNSIGNED):<br />  The id of the thread to trace. This should match the thread_id<br />  column from the performance_schema.threads table.<br />in_verbose (BOOLEAN):<br />  Include file:lineno information in the events.<br /><br />Example<br />-----------<br /><br />(line separation added for output)<br /><br />mysql> SELECT sys.ps_thread_stack(37, FALSE) AS thread_stack\G<br />*************************** 1. row ***************************<br />thread_stack: {"rankdir": "LR","nodesep": "0.10","stack_created": "2014-02-19 13:39:03",<br />"mysql_version": "5.7.3-m13","mysql_user": "root@localhost","events": <br />[{"nesting_event_id": "0", "event_id": "10", "timer_wait": 256.35, "event_info": <br />"sql/select", "wait_info": "select @@version_comment limit 1\<br />errors: 0\<br />warnings: 0\<br />lock time:<br />...</span>
          </div>
        </div>
      </div>
      <div class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">Properties</h2>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <table class="table table-hover table-bordered">
              <tbody>
                <tr>
                  <th>Name</th>
                  <th>Value</th>
                </tr>
                <tr>
                  <td>SQL Access</td>
                  <td>READS SQL DATA</td>
                </tr>
                <tr>
                  <td>Deterministic</td>
                  <td><p class="value-false">False</p></td>
                </tr>
                <tr>
                  <td>Security</td>
                  <td>Invoker</td>
                </tr>
                <tr>
                  <td>Definer</td>
                  <td>mysql.sys@'localhost'</td>
                </tr>
                <tr>
                  <td>SQL Mode</td>
                  <td>ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_ENGINE_SUBSTITUTION</td>
                </tr>
                <tr>
                  <td>Language</td>
                  <td>SQL</td>
                </tr>
                <tr>
                  <td>Created</td>
                  <td>2021. 04. 10. 15:36:58</td>
                </tr>
                <tr>
                  <td>Last Modified</td>
                  <td>2021. 04. 10. 15:36:58</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="Parameters" class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">Parameters</h2>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <table class="table table-hover table-bordered table-100">
              <tbody>
                <tr>
                  <th>Name</th>
                  <th>Data Type</th>
                  <th>Length</th>
                  <th>Precision</th>
                  <th>Scale</th>
                </tr>
                <tr>
                  <td>thd_id</td>
                  <td>BIGINT</td>
                  <td></td>
                  <td>20</td>
                  <td></td>
                </tr>
                <tr>
                  <td>debug</td>
                  <td>BOOLEAN</td>
                  <td></td>
                  <td>1</td>
                  <td></td>
                </tr>
                <tr>
                  <td>(Result)</td>
                  <td>LONGTEXT</td>
                  <td></td>
                  <td></td>
                  <td></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
      <div id="SqlScript" class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">SQL Script</h2>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <div class="zero-clipboard">
              <span class="btn-clipboard btn-default panel-default" data-clipboard-action="copy" data-clipboard-target=".SqlScript" data-toggle="tooltip" title="Copy to clipboard">Copy</span></div><div class="SqlScript  panel-default" style="word-wrap: break-word; padding-right:60px">
              <font color="#569cd6">CREATE</font>&nbsp;<font color="#569cd6">FUNCTION</font>&nbsp;<font color="#ffffff">ps_thread_stack</font><font color="#b4b4b4">(</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ffffff">thd_id</font>&nbsp;<font color="#4ec9b0">BIGINT</font>&nbsp;<font color="#569cd6">UNSIGNED</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#dcdcdc">debug</font>&nbsp;<font color="#4ec9b0">BOOLEAN</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font><br />&nbsp;&nbsp;<font color="#569cd6">RETURNS</font>&nbsp;<font color="#4ec9b0">LONGTEXT</font>&nbsp;<font color="#4ec9b0">CHARSET</font>&nbsp;<font color="#dcdcdc">latin1</font><br />&nbsp;&nbsp;<font color="#569cd6">SQL</font>&nbsp;<font color="#569cd6">SECURITY</font>&nbsp;<font color="#569cd6">INVOKER</font><br />&nbsp;&nbsp;<font color="#569cd6">READS</font>&nbsp;<font color="#569cd6">SQL</font>&nbsp;<font color="#569cd6">DATA</font><br />&nbsp;&nbsp;<font color="#569cd6">COMMENT</font>&nbsp;<font color="#d69d85">'<br />&nbsp;&nbsp;Description<br />&nbsp;&nbsp;-----------<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;Outputs a JSON formatted stack of all statements, stages and events<br />&nbsp;&nbsp;within Performance Schema for the specified thread.<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;Parameters<br />&nbsp;&nbsp;-----------<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;thd_id (BIGINT UNSIGNED):<br />&nbsp;&nbsp;  The id of the thread to trace. This should match the thread_id<br />&nbsp;&nbsp;  column from the performance_schema.threads table.<br />&nbsp;&nbsp;in_verbose (BOOLEAN):<br />&nbsp;&nbsp;  Include file:lineno information in the events.<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;Example<br />&nbsp;&nbsp;-----------<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;(line separation added for output)<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;mysql&gt; SELECT sys.ps_thread_stack(37, FALSE) AS thread_stack\\G<br />&nbsp;&nbsp;*************************** 1. row ***************************<br />&nbsp;&nbsp;thread_stack: {"rankdir": "LR","nodesep": "0.10","stack_created": "2014-02-19 13:39:03",<br />&nbsp;&nbsp;"mysql_version": "5.7.3-m13","mysql_user": "root@localhost","events": <br />&nbsp;&nbsp;[{"nesting_event_id": "0", "event_id": "10", "timer_wait": 256.35, "event_info": <br />&nbsp;&nbsp;"sql/select", "wait_info": "select @@version_comment limit 1\\<br />&nbsp;&nbsp;errors: 0\\<br />&nbsp;&nbsp;warnings: 0\\<br />&nbsp;&nbsp;lock time:<br />&nbsp;&nbsp;...<br />&nbsp;&nbsp;'</font><br /><font color="#569cd6">BEGIN</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">DECLARE</font>&nbsp;<font color="#ffffff">json_objects</font>&nbsp;<font color="#4ec9b0">LONGTEXT</font><font color="#b4b4b4">;</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Do not track the current thread, it will kill the stack</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">UPDATE</font>&nbsp;<font color="#569cd6">performance_schema</font><font color="#b4b4b4">.</font><font color="#ffffff">threads</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#4ec9b0">SET</font>&nbsp;<font color="#ffffff">instrumented</font>&nbsp;<font color="#b4b4b4">=</font>&nbsp;<font color="#d69d85">'NO'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHERE</font>&nbsp;<font color="#ffffff">processlist_id</font>&nbsp;<font color="#b4b4b4">=</font>&nbsp;<font color="#ff00ff">CONNECTION_ID</font><font color="#b4b4b4">(</font><font color="#b4b4b4">)</font><font color="#b4b4b4">;</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#4ec9b0">SET</font>&nbsp;<font color="#569cd6">SESSION</font>&nbsp;<font color="#dcdcdc">group_concat_max_len</font><font color="#b4b4b4">=</font><font color="#569cd6">@@global</font><font color="#b4b4b4">.</font><font color="#569cd6">max_allowed_packet</font><font color="#b4b4b4">;</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Select the entire stack of events</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">SELECT</font>&nbsp;<font color="#ff00ff">GROUP_CONCAT</font><font color="#b4b4b4">(</font><font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font>&nbsp;<font color="#d69d85">'{'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT_WS</font><font color="#b4b4b4">(</font>&nbsp;<font color="#d69d85">', '</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'"nesting_event_id": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">nesting_event_id</font>&nbsp;<font color="#569cd6">IS</font>&nbsp;<font color="#569cd6">NULL</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'0'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">nesting_event_id</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'"event_id": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">event_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Convert from picoseconds to microseconds</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font>&nbsp;<font color="#d69d85">'"timer_wait": '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">ROUND</font><font color="#b4b4b4">(</font><font color="#ffffff">timer_wait</font><font color="#b4b4b4">/</font><font color="#b5cea8">1000000</font><font color="#b4b4b4">,</font>&nbsp;<font color="#b5cea8">2</font><font color="#b4b4b4">)</font><font color="#b4b4b4">)</font>&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font>&nbsp;<font color="#d69d85">'"event_info": "'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">CASE</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io%'</font>&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#569cd6">REPLACE</font><font color="#b4b4b4">(</font><font color="#ff00ff">SUBSTRING_INDEX</font><font color="#b4b4b4">(</font><font color="#ffffff">event_name</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'/'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#b4b4b4">-</font><font color="#b5cea8">2</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\\\'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/file%'</font>&nbsp;<font color="#b4b4b4">OR</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/socket%'</font>&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#569cd6">REPLACE</font><font color="#b4b4b4">(</font><font color="#ff00ff">SUBSTRING_INDEX</font><font color="#b4b4b4">(</font><font color="#ffffff">event_name</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'/'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#b4b4b4">-</font><font color="#b5cea8">4</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\\\'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">ELSE</font>&nbsp;<font color="#ffffff">event_name</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">END</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Always dump the extra wait information gathered for statements</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font>&nbsp;<font color="#d69d85">'"wait_info": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">IFNULL</font><font color="#b4b4b4">(</font><font color="#ffffff">wait_info</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- If debug is enabled, add the file:lineno information for waits</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font>&nbsp;<font color="#d69d85">'"source": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#569cd6">true</font>&nbsp;<font color="#569cd6">AND</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait%'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">IFNULL</font><font color="#b4b4b4">(</font><font color="#ffffff">wait_info</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Depending on the type of event, name it appropriately</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">CASE</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/file%'</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "io/file"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/table%'</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "io/table"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/socket%'</font>&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "io/socket"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/synch/mutex%'</font>&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "synch/mutex"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/synch/cond%'</font>&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "synch/cond"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/synch/rwlock%'</font>&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "synch/rwlock"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/lock%'</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "lock"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'statement/%'</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "stmt"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'stage/%'</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "stage"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">WHEN</font>&nbsp;<font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'%idle%'</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">THEN</font>&nbsp;<font color="#d69d85">'"event_type": "idle"'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">ELSE</font>&nbsp;<font color="#d69d85">''</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">END</font>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'}'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">ORDER</font>&nbsp;<font color="#569cd6">BY</font>&nbsp;<font color="#ffffff">event_id</font>&nbsp;<font color="#569cd6">ASC</font>&nbsp;<font color="#569cd6">SEPARATOR</font>&nbsp;<font color="#d69d85">','</font><font color="#b4b4b4">)</font>&nbsp;<font color="#569cd6">event</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">INTO</font>&nbsp;<font color="#ffffff">json_objects</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">FROM</font>&nbsp;<font color="#b4b4b4">(</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Select all statements, with the extra tracing information available</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">(</font><font color="#569cd6">SELECT</font>&nbsp;<font color="#ffffff">thread_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">event_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">event_name</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">timer_wait</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">timer_start</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">nesting_event_id</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#ffffff">sql_text</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'errors: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">errors</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'warnings: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">warnings</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'lock time: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">ROUND</font><font color="#b4b4b4">(</font><font color="#ffffff">lock_time</font><font color="#b4b4b4">/</font><font color="#b5cea8">1000000</font><font color="#b4b4b4">,</font>&nbsp;<font color="#b5cea8">2</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><font color="#d69d85">'us\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'rows affected: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">rows_affected</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'rows sent: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">rows_sent</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'rows examined: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">rows_examined</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'tmp tables: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">created_tmp_tables</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'tmp disk tables: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">created_tmp_disk_tables</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'select scan: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">select_scan</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'select full join: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">select_full_join</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'select full range join: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">select_full_range_join</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'select range: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">select_range</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'select range check: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">select_range_check</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'sort merge passes: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">sort_merge_passes</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'sort rows: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">sort_rows</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'sort range: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">sort_range</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'sort scan: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">sort_scan</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'no index used: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">no_index_used</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'TRUE'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'FALSE'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'no good index used: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">no_good_index_used</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'TRUE'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'FALSE'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font>&nbsp;<font color="#569cd6">AS</font>&nbsp;<font color="#ffffff">wait_info</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">FROM</font>&nbsp;<font color="#569cd6">performance_schema</font><font color="#b4b4b4">.</font><font color="#ffffff">events_statements_history_long</font>&nbsp;<font color="#569cd6">WHERE</font>&nbsp;<font color="#ffffff">thread_id</font>&nbsp;<font color="#b4b4b4">=</font>&nbsp;<font color="#ffffff">thd_id</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">UNION</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Select all stages</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">(</font><font color="#569cd6">SELECT</font>&nbsp;<font color="#ffffff">thread_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">event_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">event_name</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">timer_wait</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">timer_start</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">nesting_event_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">null</font>&nbsp;<font color="#569cd6">AS</font>&nbsp;<font color="#ffffff">wait_info</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">FROM</font>&nbsp;<font color="#569cd6">performance_schema</font><font color="#b4b4b4">.</font><font color="#ffffff">events_stages_history_long</font>&nbsp;<font color="#569cd6">WHERE</font>&nbsp;<font color="#ffffff">thread_id</font>&nbsp;<font color="#b4b4b4">=</font>&nbsp;<font color="#ffffff">thd_id</font><font color="#b4b4b4">)</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">UNION</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Select all events, adding information appropriate to the event</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">(</font><font color="#569cd6">SELECT</font>&nbsp;<font color="#ffffff">thread_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">event_id</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#ffffff">event_name</font>&nbsp;<font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">event_name</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/synch/mutex%'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">IFNULL</font><font color="#b4b4b4">(</font><font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">' - '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">operation</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">number_of_bytes</font>&nbsp;<font color="#569cd6">IS</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">NULL</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">' '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">number_of_bytes</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">' bytes'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/file%'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'\\n'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">object_schema</font>&nbsp;<font color="#569cd6">IS</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">NULL</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'\\nObject: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">object_schema</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'.'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">object_name</font>&nbsp;<font color="#569cd6">IS</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">NULL</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font>&nbsp;<font color="#b4b4b4">(</font><font color="#ffffff">event_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">'wait/io/socket%'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#608b4e">-- Print the socket if used, else the IP:port as reported</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#569cd6">IF</font>&nbsp;<font color="#b4b4b4">(</font><font color="#ffffff">object_name</font>&nbsp;<font color="#569cd6">LIKE</font>&nbsp;<font color="#d69d85">':0%'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">@@socket</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">object_name</font><font color="#b4b4b4">)</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ffffff">object_name</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">IF</font><font color="#b4b4b4">(</font><font color="#ffffff">index_name</font>&nbsp;<font color="#569cd6">IS</font>&nbsp;<font color="#b4b4b4">NOT</font>&nbsp;<font color="#569cd6">NULL</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">' Index: '</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">index_name</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><font color="#d69d85">'\\n'</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font>&nbsp;<font color="#569cd6">AS</font>&nbsp;<font color="#ffffff">event_name</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ffffff">timer_wait</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">timer_start</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ffffff">nesting_event_id</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">source</font>&nbsp;<font color="#569cd6">AS</font>&nbsp;<font color="#ffffff">wait_info</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">FROM</font>&nbsp;<font color="#569cd6">performance_schema</font><font color="#b4b4b4">.</font><font color="#ffffff">events_waits_history_long</font>&nbsp;<font color="#569cd6">WHERE</font>&nbsp;<font color="#ffffff">thread_id</font>&nbsp;<font color="#b4b4b4">=</font>&nbsp;<font color="#ffffff">thd_id</font><font color="#b4b4b4">)</font><font color="#b4b4b4">)</font>&nbsp;<font color="#569cd6">events</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">ORDER</font>&nbsp;<font color="#569cd6">BY</font>&nbsp;<font color="#ffffff">event_id</font><font color="#b4b4b4">;</font><br />&nbsp;&nbsp;&nbsp;&nbsp;<font color="#569cd6">RETURN</font>&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'{'</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT_WS</font><font color="#b4b4b4">(</font><font color="#d69d85">','</font><font color="#b4b4b4">,</font>&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'"rankdir": "LR"'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'"nodesep": "0.10"'</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'"stack_created": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">NOW</font><font color="#b4b4b4">(</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'"mysql_version": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">VERSION</font><font color="#b4b4b4">(</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'"mysql_user": "'</font><font color="#b4b4b4">,</font>&nbsp;<font color="#569cd6">CURRENT_USER</font><font color="#b4b4b4">(</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">'"'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff00ff">CONCAT</font><font color="#b4b4b4">(</font><font color="#d69d85">'"events": ['</font><font color="#b4b4b4">,</font>&nbsp;<font color="#ff00ff">IFNULL</font><font color="#b4b4b4">(</font><font color="#ffffff">json_objects</font><font color="#b4b4b4">,</font><font color="#d69d85">''</font><font color="#b4b4b4">)</font><font color="#b4b4b4">,</font>&nbsp;<font color="#d69d85">']'</font><font color="#b4b4b4">)</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#b4b4b4">)</font><font color="#b4b4b4">,</font><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#d69d85">'}'</font><font color="#b4b4b4">)</font><font color="#b4b4b4">;</font><br /><font color="#569cd6">END</font></div>
          </div>
        </div>
      </div>
      <div id="DependsOn" class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">Depends On</h2>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <span class="text-muted">No items found</span>
          </div>
        </div>
      </div>
      <div id="UsedBy" class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">Used By</h2>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <span class="text-muted">No items found</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <div class="col-xs-4">Author:&nbsp;</div>
    <div class="col-xs-4 align-center">Copyright &#169; All Rights Reserved</div>
    <div class="col-xs-4 align-right">Created:&nbsp;10. 04. 2021</div>
  </div>
</body>
</html>