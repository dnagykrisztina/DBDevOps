<!DOCTYPE HTML>
<html lang="en">
<head>
<meta http-equiv="content-type" content="text/html;charset=utf-8" />
<title>Procedures</title>
<script src="../../../../../scripts/jquery-1.12.0.min.js" type="text/javascript"></script>
<script src="../../../../../scripts/bootstrap.min.js" type="text/javascript"></script>
<script src="../../../../../scripts/clipboard.min.js" type="text/javascript"></script>
<script src="../../../../../scripts/main.js" type="text/javascript"></script>
<link rel="stylesheet" href="../../../../../styles/bootstrap/Default Dark.css" type="text/css">
<link rel="stylesheet" href="../../../../../styles/main.css" type="text/css">
</head>
<body class="watermark">

  <div class="page-wrap">
    <div class="header">
      <div class="row">
        <div class="col-xs-12">
          <ol class="breadcrumb">
            <li><a href="../../../../../startpage.html" data-mapping-enabled="true">Project</a></li>
            <li><a href="../../../../../Servers\Servers.html" data-mapping-enabled="true">Servers</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Cars.localhost.html" data-mapping-enabled="true">Cars.localhost</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Databases\Databases.html" data-mapping-enabled="true">Databases</a></li>
            <li><a href="../../../../../Servers\Cars.localhost\Databases\sys\sys.html" data-mapping-enabled="true">sys</a></li>
            <li class="active">Procedures</li>
          </ol>
        </div>
      </div>
      <div class="row">
        <div class="title col-xs-12">
          <div><img class="inline-middle image-large" src="../../../../../images/Dark\folder.svg" title="Procedures" />
            <h1 class="inline-middle">Procedures</h1>
            <div class="dropdown actions-btn-wrap">
              <button type="button" class="btn btn-default actions-btn" data-toggle="dropdown"><span class="icon-actions icon-small actions-btn-span"></span></button>
              <ul class="dropdown-menu dropdown-menu-right">
                <li><a id="CollapseAll" href="#">Collapse All</a></li>
                <li><a id="ExpandAll" href="#">Expand All</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="content">


      <div id="Procedures" class="panel panel-default">
        <div class="panel-heading">
          <span class="icon-bottom inline-middle expanded icon-small"></span>
          <span class="icon-right inline-middle collapsed icon-small" style="display:none"></span>
          <h2 class="inline-middle">Objects</h2>
          <span class="badge inline-middle">26</span>
        </div>
        <div class="panel-collapse collapse in">
          <div class="panel-body">
            <table class="table table-hover table-bordered table-100">
              <tbody>
                <tr>
                  <th>Name</th>
                  <th class="column-description-60">Description</th>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\create_synonym_db.html" data-mapping-enabled="true"><span>create_synonym_db</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Takes a source database name and synonym name, and then creates the <br />synonym database with views that point to all of the tables within<br />the source database.<br /><br />Useful for creating a "ps" synonym for "performance_schema",<br />or "is" instead of "information_schema", for example.<br /><br />Parameters<br />-----------<br /><br />in_db_name (VARCHAR(64)):<br />  The database name that you would like to create a synonym for.<br />in_synonym (VARCHAR(64)):<br />  The database synonym name.<br /><br />Example<br />-----------<br /><br />mysql> SHOW DATABASES;<br />+--------------------+<br />| Database           |<br />+--------------------+<br />| information_schema |<br />| mysql              |<br />| performance_schema |<br />| sys                |<br />| test               |<br />+--------------------+<br />5 rows in set (0.00 sec)<br /><br />mysql> CALL sys.create_synonym_db('performance_schema', 'ps');<br />+---------------------------------------+<br />| summary                               |<br />+---------------------------------------+<br />| Created 74 views in the `ps` database |<br />+---------------------------------------+<br />1 row in set (8.57 sec)<br /><br />Query OK, 0 rows affected (8.57 sec)<br /><br />mysql> SHOW DATABASES;<br />+--------------------+<br />| Database           |<br />+--------------------+<br />| information_schema |<br />| mysql              |<br />| performance_schema |<br />| ps                 |<br />| sys                |<br />| test               |<br />+--------------------+<br />6 rows in set (0.00 sec)<br /><br />mysql> SHOW FULL TABLES FROM ps;<br />+------------------------------------------------------+------------+<br />| Tables_in_ps                                         | Table_type |<br />+------------------------------------------------------+------------+<br />| accounts                                             | VIEW       |<br />| cond_instances                                       | VIEW       |<br />| events_stages_current                                | VIEW       |<br />| events_stages_history                                | VIEW       |<br />...</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\diagnostics.html" data-mapping-enabled="true"><span>diagnostics</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Create a report of the current status of the server for diagnostics purposes. Data collected includes (some items depends on versions and settings):<br /><br />   * The GLOBAL VARIABLES<br />   * Several sys schema views including metrics or equivalent (depending on version and settings)<br />   * Queries in the 95th percentile<br />   * Several ndbinfo views for MySQL Cluster<br />   * Replication (both master and slave) information.<br /><br />Some of the sys schema views are calculated as initial (optional), overall, delta:<br /><br />   * The initial view is the content of the view at the start of this procedure.<br />     This output will be the same as the the start values used for the delta view.<br />     The initial view is included if @sys.diagnostics.include_raw = 'ON'.<br />   * The overall view is the content of the view at the end of this procedure.<br />     This output is the same as the end values used for the delta view.<br />     The overall view is always included.<br />   * The delta view is the difference from the beginning to the end. Note that for min and max values<br />     they are simply the min or max value from the end view respectively, so does not necessarily reflect<br />     the minimum/maximum value in the monitored period.<br />     Note: except for the metrics views the delta is only calculation between the first and last outputs.<br /><br />Requires the SUPER privilege for "SET sql_log_bin = 0;".<br /><br />Parameters<br />-----------<br /><br />in_max_runtime (INT UNSIGNED):<br />  The maximum time to keep collecting data.<br />  Use NULL to get the default which is 60 seconds, otherwise enter a value greater than 0.<br />in_interval (INT UNSIGNED):<br />  How long to sleep between data collections.<br />  Use NULL to get the default which is 30 seconds, otherwise enter a value greater than 0.<br />in_auto_config (ENUM('current', 'medium', 'full'))<br />  Automatically enable Performance Schema instruments and consumers.<br />  NOTE: The more that are enabled, the more impact on the performance.<br />  Supported values are:<br />     * current - use the current settings.<br />     * medium - enable some settings. This requires the SUPER privilege.<br />     * full - enables all settings. This will have a big impact on the<br />              performance - be careful using this option. This requires<br />              the SUPER privilege.<br />  If another setting the 'current' is chosen, the current settings<br />  are restored at the end of the procedure.<br /><br /><br />Configuration Options<br />----------------------<br /><br />sys.diagnostics.allow_i_s_tables<br />  Specifies whether it is allowed to do table scan queries on information_schema.TABLES. This can be expensive if there<br />  are many tables. Set to 'ON' to allow, 'OFF' to not allow.<br />  Default is 'OFF'.<br /><br />sys.diagnostics.include_raw<br />  Set to 'ON' to include the raw data (e.g. the original output of "SELECT * FROM sys.metrics").<br />  Use this to get the initial values of the various views.<br />  Default is 'OFF'.<br /><br />sys.statement_truncate_len<br />  How much of queries in the process list output to include.<br />  Default is 64.<br /><br />sys.debug<br />  Whether to provide debugging output.<br />  Default is 'OFF'. Set to 'ON' to include.<br /><br /><br />Example<br />--------<br /><br />To create a report and append it to the file diag.out:<br /><br />mysql> TEE diag.out;<br />mysql> CALL sys.diagnostics(120, 30, 'current');<br />...<br />mysql> NOTEE;</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\execute_prepared_stmt.html" data-mapping-enabled="true"><span>execute_prepared_stmt</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Takes the query in the argument and executes it using a prepared statement. The prepared statement is deallocated,<br />so the procedure is mainly useful for executing one off dynamically created queries.<br /><br />The sys_execute_prepared_stmt prepared statement name is used for the query and is required not to exist.<br /><br /><br />Parameters<br />-----------<br /><br />in_query (longtext CHARACTER SET UTF8MB4):<br />  The query to execute.<br /><br /><br />Configuration Options<br />----------------------<br /><br />sys.debug<br />  Whether to provide debugging output.<br />  Default is 'OFF'. Set to 'ON' to include.<br /><br /><br />Example<br />--------<br /><br />mysql> CALL sys.execute_prepared_stmt('SELECT * FROM sys.sys_config');<br />+------------------------+-------+---------------------+--------+<br />| variable               | value | set_time            | set_by |<br />+------------------------+-------+---------------------+--------+<br />| statement_truncate_len | 64    | 2015-06-30 13:06:00 | NULL   |<br />+------------------------+-------+---------------------+--------+<br />1 row in set (0.00 sec)<br /><br />Query OK, 0 rows affected (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_disable_background_threads.html" data-mapping-enabled="true"><span>ps_setup_disable_background_threads</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Disable all background thread instrumentation within Performance Schema.<br /><br />Parameters<br />-----------<br /><br />None.<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_disable_background_threads();<br />+--------------------------------+<br />| summary                        |<br />+--------------------------------+<br />| Disabled 18 background threads |<br />+--------------------------------+<br />1 row in set (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_disable_consumer.html" data-mapping-enabled="true"><span>ps_setup_disable_consumer</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Disables consumers within Performance Schema <br />matching the input pattern.<br /><br />Parameters<br />-----------<br /><br />consumer (VARCHAR(128)):<br />  A LIKE pattern match (using "%consumer%") of consumers to disable<br /><br />Example<br />-----------<br /><br />To disable all consumers:<br /><br />mysql> CALL sys.ps_setup_disable_consumer('');<br />+--------------------------+<br />| summary                  |<br />+--------------------------+<br />| Disabled 15 consumers    |<br />+--------------------------+<br />1 row in set (0.02 sec)<br /><br />To disable just the event_stage consumers:<br /><br />mysql> CALL sys.ps_setup_disable_comsumers('stage');<br />+------------------------+<br />| summary                |<br />+------------------------+<br />| Disabled 3 consumers   |<br />+------------------------+<br />1 row in set (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_disable_instrument.html" data-mapping-enabled="true"><span>ps_setup_disable_instrument</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Disables instruments within Performance Schema <br />matching the input pattern.<br /><br />Parameters<br />-----------<br /><br />in_pattern (VARCHAR(128)):<br />  A LIKE pattern match (using "%in_pattern%") of events to disable<br /><br />Example<br />-----------<br /><br />To disable all mutex instruments:<br /><br />mysql> CALL sys.ps_setup_disable_instrument('wait/synch/mutex');<br />+--------------------------+<br />| summary                  |<br />+--------------------------+<br />| Disabled 155 instruments |<br />+--------------------------+<br />1 row in set (0.02 sec)<br /><br />To disable just a specific TCP/IP based network IO instrument:<br /><br />mysql> CALL sys.ps_setup_disable_instrument('wait/io/socket/sql/server_tcpip_socket');<br />+------------------------+<br />| summary                |<br />+------------------------+<br />| Disabled 1 instruments |<br />+------------------------+<br />1 row in set (0.00 sec)<br /><br />To disable all instruments:<br /><br />mysql> CALL sys.ps_setup_disable_instrument('');<br />+--------------------------+<br />| summary                  |<br />+--------------------------+<br />| Disabled 547 instruments |<br />+--------------------------+<br />1 row in set (0.01 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_disable_thread.html" data-mapping-enabled="true"><span>ps_setup_disable_thread</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Disable the given connection/thread in Performance Schema.<br /><br />Parameters<br />-----------<br /><br />in_connection_id (BIGINT):<br />  The connection ID (PROCESSLIST_ID from performance_schema.threads<br />  or the ID shown within SHOW PROCESSLIST)<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_disable_thread(3);<br />+-------------------+<br />| summary           |<br />+-------------------+<br />| Disabled 1 thread |<br />+-------------------+<br />1 row in set (0.01 sec)<br /><br />To disable the current connection:<br /><br />mysql> CALL sys.ps_setup_disable_thread(CONNECTION_ID());<br />+-------------------+<br />| summary           |<br />+-------------------+<br />| Disabled 1 thread |<br />+-------------------+<br />1 row in set (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_enable_background_threads.html" data-mapping-enabled="true"><span>ps_setup_enable_background_threads</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Enable all background thread instrumentation within Performance Schema.<br /><br />Parameters<br />-----------<br /><br />None.<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_enable_background_threads();<br />+-------------------------------+<br />| summary                       |<br />+-------------------------------+<br />| Enabled 18 background threads |<br />+-------------------------------+<br />1 row in set (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_enable_consumer.html" data-mapping-enabled="true"><span>ps_setup_enable_consumer</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Enables consumers within Performance Schema <br />matching the input pattern.<br /><br />Parameters<br />-----------<br /><br />consumer (VARCHAR(128)):<br />  A LIKE pattern match (using "%consumer%") of consumers to enable<br /><br />Example<br />-----------<br /><br />To enable all consumers:<br /><br />mysql> CALL sys.ps_setup_enable_consumer('');<br />+-------------------------+<br />| summary                 |<br />+-------------------------+<br />| Enabled 10 consumers    |<br />+-------------------------+<br />1 row in set (0.02 sec)<br /><br />Query OK, 0 rows affected (0.02 sec)<br /><br />To enable just "waits" consumers:<br /><br />mysql> CALL sys.ps_setup_enable_consumer('waits');<br />+-----------------------+<br />| summary               |<br />+-----------------------+<br />| Enabled 3 consumers   |<br />+-----------------------+<br />1 row in set (0.00 sec)<br /><br />Query OK, 0 rows affected (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_enable_instrument.html" data-mapping-enabled="true"><span>ps_setup_enable_instrument</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Enables instruments within Performance Schema <br />matching the input pattern.<br /><br />Parameters<br />-----------<br /><br />in_pattern (VARCHAR(128)):<br />  A LIKE pattern match (using "%in_pattern%") of events to enable<br /><br />Example<br />-----------<br /><br />To enable all mutex instruments:<br /><br />mysql> CALL sys.ps_setup_enable_instrument('wait/synch/mutex');<br />+-------------------------+<br />| summary                 |<br />+-------------------------+<br />| Enabled 155 instruments |<br />+-------------------------+<br />1 row in set (0.02 sec)<br /><br />Query OK, 0 rows affected (0.02 sec)<br /><br />To enable just a specific TCP/IP based network IO instrument:<br /><br />mysql> CALL sys.ps_setup_enable_instrument('wait/io/socket/sql/server_tcpip_socket');<br />+-----------------------+<br />| summary               |<br />+-----------------------+<br />| Enabled 1 instruments |<br />+-----------------------+<br />1 row in set (0.00 sec)<br /><br />Query OK, 0 rows affected (0.00 sec)<br /><br />To enable all instruments:<br /><br />mysql> CALL sys.ps_setup_enable_instrument('');<br />+-------------------------+<br />| summary                 |<br />+-------------------------+<br />| Enabled 547 instruments |<br />+-------------------------+<br />1 row in set (0.01 sec)<br /><br />Query OK, 0 rows affected (0.01 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_enable_thread.html" data-mapping-enabled="true"><span>ps_setup_enable_thread</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Enable the given connection/thread in Performance Schema.<br /><br />Parameters<br />-----------<br /><br />in_connection_id (BIGINT):<br />  The connection ID (PROCESSLIST_ID from performance_schema.threads<br />  or the ID shown within SHOW PROCESSLIST)<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_enable_thread(3);<br />+------------------+<br />| summary          |<br />+------------------+<br />| Enabled 1 thread |<br />+------------------+<br />1 row in set (0.01 sec)<br /><br />To enable the current connection:<br /><br />mysql> CALL sys.ps_setup_enable_thread(CONNECTION_ID());<br />+------------------+<br />| summary          |<br />+------------------+<br />| Enabled 1 thread |<br />+------------------+<br />1 row in set (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_reload_saved.html" data-mapping-enabled="true"><span>ps_setup_reload_saved</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Reloads a saved Performance Schema configuration,<br />so that you can alter the setup for debugging purposes, <br />but restore it to a previous state.<br /><br />Use the companion procedure - ps_setup_save(), to <br />save a configuration.<br /><br />Requires the SUPER privilege for "SET sql_log_bin = 0;".<br /><br />Parameters<br />-----------<br /><br />None.<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_save();<br />Query OK, 0 rows affected (0.08 sec)<br /><br />mysql> UPDATE performance_schema.setup_instruments SET enabled = 'YES', timed = 'YES';<br />Query OK, 547 rows affected (0.40 sec)<br />Rows matched: 784  Changed: 547  Warnings: 0<br /><br />/* Run some tests that need more detailed instrumentation here */<br /><br />mysql> CALL sys.ps_setup_reload_saved();<br />Query OK, 0 rows affected (0.32 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_reset_to_default.html" data-mapping-enabled="true"><span>ps_setup_reset_to_default</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Resets the Performance Schema setup to the default settings.<br /><br />Parameters<br />-----------<br /><br />in_verbose (BOOLEAN):<br />  Whether to print each setup stage (including the SQL) whilst running.<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_reset_to_default(true)\G<br />*************************** 1. row ***************************<br />status: Resetting: setup_actors<br />DELETE<br />FROM performance_schema.setup_actors<br /> WHERE NOT (HOST = '%' AND USER = '%' AND `ROLE` = '%')<br />1 row in set (0.00 sec)<br /><br />*************************** 1. row ***************************<br />status: Resetting: setup_actors<br />INSERT IGNORE INTO performance_schema.setup_actors<br />VALUES ('%', '%', '%')<br />1 row in set (0.00 sec)<br />...<br /><br />mysql> CALL sys.ps_setup_reset_to_default(false)\G<br />Query OK, 0 rows affected (0.00 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_save.html" data-mapping-enabled="true"><span>ps_setup_save</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Saves the current configuration of Performance Schema, <br />so that you can alter the setup for debugging purposes, <br />but restore it to a previous state.<br /><br />Use the companion procedure - ps_setup_reload_saved(), to <br />restore the saved config.<br /><br />The named lock "sys.ps_setup_save" is taken before the<br />current configuration is saved. If the attempt to get the named<br />lock times out, an error occurs.<br /><br />The lock is released after the settings have been restored by<br />calling ps_setup_reload_saved().<br /><br />Requires the SUPER privilege for "SET sql_log_bin = 0;".<br /><br />Parameters<br />-----------<br /><br />in_timeout INT<br />  The timeout in seconds used when trying to obtain the lock.<br />  A negative timeout means infinite timeout.<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_save(-1);<br />Query OK, 0 rows affected (0.08 sec)<br /><br />mysql> UPDATE performance_schema.setup_instruments <br />    ->    SET enabled = 'YES', timed = 'YES';<br />Query OK, 547 rows affected (0.40 sec)<br />Rows matched: 784  Changed: 547  Warnings: 0<br /><br />/* Run some tests that need more detailed instrumentation here */<br /><br />mysql> CALL sys.ps_setup_reload_saved();<br />Query OK, 0 rows affected (0.32 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_show_disabled.html" data-mapping-enabled="true"><span>ps_setup_show_disabled</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Shows all currently disable Performance Schema configuration.<br /><br />Disabled users is only available for MySQL 5.7.6 and later.<br />In earlier versions it was only possible to enable users.<br /><br />Parameters<br />-----------<br /><br />in_show_instruments (BOOLEAN):<br />  Whether to print disabled instruments (can print many items)<br /><br />in_show_threads (BOOLEAN):<br />  Whether to print disabled threads<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_show_disabled(TRUE, TRUE);<br />+----------------------------+<br />| performance_schema_enabled |<br />+----------------------------+<br />|                          1 |<br />+----------------------------+<br />1 row in set (0.00 sec)<br /><br />+--------------------+<br />| disabled_users     |<br />+--------------------+<br />| 'mark'@'localhost' |<br />+--------------------+<br />1 row in set (0.00 sec)<br /><br />+-------------+----------------------+---------+-------+<br />| object_type | objects              | enabled | timed |<br />+-------------+----------------------+---------+-------+<br />| EVENT       | mysql.%              | NO      | NO    |<br />| EVENT       | performance_schema.% | NO      | NO    |<br />| EVENT       | information_schema.% | NO      | NO    |<br />| FUNCTION    | mysql.%              | NO      | NO    |<br />| FUNCTION    | performance_schema.% | NO      | NO    |<br />| FUNCTION    | information_schema.% | NO      | NO    |<br />| PROCEDURE   | mysql.%              | NO      | NO    |<br />| PROCEDURE   | performance_schema.% | NO      | NO    |<br />| PROCEDURE   | information_schema.% | NO      | NO    |<br />| TABLE       | mysql.%              | NO      | NO    |<br />| TABLE       | performance_schema.% | NO      | NO    |<br />| TABLE       | information_schema.% | NO      | NO    |<br />| TRIGGER     | mysql.%              | NO      | NO    |<br />| TRIGGER     | performance_schema.% | NO      | NO    |<br />| TRIGGER     | information_schema.% | NO      | NO    |<br />+-------------+----------------------+---------+-------+<br />15 rows in set (0.00 sec)<br /><br />+----------------------------------+<br />| disabled_consumers               |<br />+----------------------------------+<br />| events_stages_current            |<br />| events_stages_history            |<br />| events_stages_history_long       |<br />| events_statements_history        |<br />| events_statements_history_long   |<br />| events_transactions_history      |<br />| events_transactions_history_long |<br />| events_waits_current             |<br />| events_waits_history             |<br />| events_waits_history_long        |<br />+----------------------------------+<br />10 rows in set (0.00 sec)<br /><br />Empty set (0.00 sec)<br /><br />+---------------------------------------------------------------------------------------+-------+<br />| disabled_instruments                                                                  | timed |<br />+---------------------------------------------------------------------------------------+-------+<br />| wait/synch/mutex/sql/TC_LOG_MMAP::LOCK_tc                                             | NO    |<br />| wait/synch/mutex/sql/LOCK_des_key_file                                                | NO    |<br />| wait/synch/mutex/sql/MYSQL_BIN_LOG::LOCK_commit                                       | NO    |<br />...<br />| memory/sql/servers_cache                                                              | NO    |<br />| memory/sql/udf_mem                                                                    | NO    |<br />| wait/lock/metadata/sql/mdl                                                            | NO    |<br />+---------------------------------------------------------------------------------------+-------+<br />547 rows in set (0.00 sec)<br /><br />Query OK, 0 rows affected (0.01 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_show_disabled_consumers.html" data-mapping-enabled="true"><span>ps_setup_show_disabled_consumers</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Shows all currently disabled consumers.<br /><br />Parameters<br />-----------<br /><br />None<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_show_disabled_consumers();<br /><br />+---------------------------+<br />| disabled_consumers        |<br />+---------------------------+<br />| events_statements_current |<br />| global_instrumentation    |<br />| thread_instrumentation    |<br />| statements_digest         |<br />+---------------------------+<br />4 rows in set (0.05 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_show_disabled_instruments.html" data-mapping-enabled="true"><span>ps_setup_show_disabled_instruments</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Shows all currently disabled instruments.<br /><br />Parameters<br />-----------<br /><br />None<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_show_disabled_instruments();</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_show_enabled.html" data-mapping-enabled="true"><span>ps_setup_show_enabled</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Shows all currently enabled Performance Schema configuration.<br /><br />Parameters<br />-----------<br /><br />in_show_instruments (BOOLEAN):<br />  Whether to print enabled instruments (can print many items)<br /><br />in_show_threads (BOOLEAN):<br />  Whether to print enabled threads<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_show_enabled(TRUE, TRUE);<br />+----------------------------+<br />| performance_schema_enabled |<br />+----------------------------+<br />|                          1 |<br />+----------------------------+<br />1 row in set (0.00 sec)<br /><br />+---------------+<br />| enabled_users |<br />+---------------+<br />| '%'@'%'       |<br />+---------------+<br />1 row in set (0.01 sec)<br /><br />+-------------+---------+---------+-------+<br />| object_type | objects | enabled | timed |<br />+-------------+---------+---------+-------+<br />| EVENT       | %.%     | YES     | YES   |<br />| FUNCTION    | %.%     | YES     | YES   |<br />| PROCEDURE   | %.%     | YES     | YES   |<br />| TABLE       | %.%     | YES     | YES   |<br />| TRIGGER     | %.%     | YES     | YES   |<br />+-------------+---------+---------+-------+<br />5 rows in set (0.01 sec)<br /><br />+---------------------------+<br />| enabled_consumers         |<br />+---------------------------+<br />| events_statements_current |<br />| global_instrumentation    |<br />| thread_instrumentation    |<br />| statements_digest         |<br />+---------------------------+<br />4 rows in set (0.05 sec)<br /><br />+---------------------------------+-------------+<br />| enabled_threads                 | thread_type |<br />+---------------------------------+-------------+<br />| sql/main                        | BACKGROUND  |<br />| sql/thread_timer_notifier       | BACKGROUND  |<br />| innodb/io_ibuf_thread           | BACKGROUND  |<br />| innodb/io_log_thread            | BACKGROUND  |<br />| innodb/io_read_thread           | BACKGROUND  |<br />| innodb/io_read_thread           | BACKGROUND  |<br />| innodb/io_write_thread          | BACKGROUND  |<br />| innodb/io_write_thread          | BACKGROUND  |<br />| innodb/page_cleaner_thread      | BACKGROUND  |<br />| innodb/srv_lock_timeout_thread  | BACKGROUND  |<br />| innodb/srv_error_monitor_thread | BACKGROUND  |<br />| innodb/srv_monitor_thread       | BACKGROUND  |<br />| innodb/srv_master_thread        | BACKGROUND  |<br />| innodb/srv_purge_thread         | BACKGROUND  |<br />| innodb/srv_worker_thread        | BACKGROUND  |<br />| innodb/srv_worker_thread        | BACKGROUND  |<br />| innodb/srv_worker_thread        | BACKGROUND  |<br />| innodb/buf_dump_thread          | BACKGROUND  |<br />| innodb/dict_stats_thread        | BACKGROUND  |<br />| sql/signal_handler              | BACKGROUND  |<br />| sql/compress_gtid_table         | FOREGROUND  |<br />| root@localhost                  | FOREGROUND  |<br />+---------------------------------+-------------+<br />22 rows in set (0.01 sec)<br /><br />+-------------------------------------+-------+<br />| enabled_instruments                 | timed |<br />+-------------------------------------+-------+<br />| wait/io/file/sql/map                | YES   |<br />| wait/io/file/sql/binlog             | YES   |<br />...<br />| statement/com/Error                 | YES   |<br />| statement/com/                      | YES   |<br />| idle                                | YES   |<br />+-------------------------------------+-------+<br />210 rows in set (0.08 sec)<br /><br />Query OK, 0 rows affected (0.89 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_show_enabled_consumers.html" data-mapping-enabled="true"><span>ps_setup_show_enabled_consumers</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Shows all currently enabled consumers.<br /><br />Parameters<br />-----------<br /><br />None<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_show_enabled_consumers();<br /><br />+---------------------------+<br />| enabled_consumers         |<br />+---------------------------+<br />| events_statements_current |<br />| global_instrumentation    |<br />| thread_instrumentation    |<br />| statements_digest         |<br />+---------------------------+<br />4 rows in set (0.05 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_setup_show_enabled_instruments.html" data-mapping-enabled="true"><span>ps_setup_show_enabled_instruments</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Shows all currently enabled instruments.<br /><br />Parameters<br />-----------<br /><br />None<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_setup_show_enabled_instruments();</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_statement_avg_latency_histogram.html" data-mapping-enabled="true"><span>ps_statement_avg_latency_histogram</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Outputs a textual histogram graph of the average latency values<br />across all normalized queries tracked within the Performance Schema<br />events_statements_summary_by_digest table.<br /><br />Can be used to show a very high level picture of what kind of <br />latency distribution statements running within this instance have.<br /><br />Parameters<br />-----------<br /><br />None.<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_statement_avg_latency_histogram()\G<br />*************************** 1. row ***************************<br />Performance Schema Statement Digest Average Latency Histogram:<br /><br />  . = 1 unit<br />  * = 2 units<br />  # = 3 units<br /><br />(0 - 38ms)     240 | ################################################################################<br />(38 - 77ms)    38  | ......................................<br />(77 - 115ms)   3   | ...<br />(115 - 154ms)  62  | *******************************<br />(154 - 192ms)  3   | ...<br />(192 - 231ms)  0   |<br />(231 - 269ms)  0   |<br />(269 - 307ms)  0   |<br />(307 - 346ms)  0   |<br />(346 - 384ms)  1   | .<br />(384 - 423ms)  1   | .<br />(423 - 461ms)  0   |<br />(461 - 499ms)  0   |<br />(499 - 538ms)  0   |<br />(538 - 576ms)  0   |<br />(576 - 615ms)  1   | .<br /><br />  Total Statements: 350; Buckets: 16; Bucket Size: 38 ms;</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_trace_statement_digest.html" data-mapping-enabled="true"><span>ps_trace_statement_digest</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Traces all instrumentation within Performance Schema for a specific<br />Statement Digest.<br /><br />When finding a statement of interest within the<br />performance_schema.events_statements_summary_by_digest table, feed<br />the DIGEST value in to this procedure, set how long to poll for,<br />and at what interval to poll, and it will generate a report of all<br />statistics tracked within Performance Schema for that digest for the<br />interval.<br /><br />It will also attempt to generate an EXPLAIN for the longest running<br />example of the digest during the interval. Note this may fail, as:<br /><br />   * Performance Schema truncates long SQL_TEXT values (and hence the<br />     EXPLAIN will fail due to parse errors)<br />   * the default schema is sys (so tables that are not fully qualified<br />     in the query may not be found)<br />   * some queries such as SHOW are not supported in EXPLAIN.<br /><br />When the EXPLAIN fails, the error will be ignored and no EXPLAIN<br />output generated.<br /><br />Requires the SUPER privilege for "SET sql_log_bin = 0;".<br /><br />Parameters<br />-----------<br /><br />in_digest (VARCHAR(64)):<br />  The statement digest identifier you would like to analyze<br />in_runtime (INT):<br />  The number of seconds to run analysis for<br />in_interval (DECIMAL(2,2)):<br />  The interval (in seconds, may be fractional) at which to try<br />  and take snapshots<br />in_start_fresh (BOOLEAN):<br />  Whether to TRUNCATE the events_statements_history_long and<br />  events_stages_history_long tables before starting<br />in_auto_enable (BOOLEAN):<br />  Whether to automatically turn on required consumers<br /><br />Example<br />-----------<br /><br />mysql> call ps_trace_statement_digest('891ec6860f98ba46d89dd20b0c03652c', 10, 0.1, true, true);<br />+--------------------+<br />| SUMMARY STATISTICS |<br />+--------------------+<br />| SUMMARY STATISTICS |<br />+--------------------+<br />1 row in set (9.11 sec)<br /><br />+------------+-----------+-----------+-----------+---------------+------------+------------+<br />| executions | exec_time | lock_time | rows_sent | rows_examined | tmp_tables | full_scans |<br />+------------+-----------+-----------+-----------+---------------+------------+------------+<br />|         21 | 4.11 ms   | 2.00 ms   |         0 |            21 |          0 |          0 |<br />+------------+-----------+-----------+-----------+---------------+------------+------------+<br />1 row in set (9.11 sec)<br /><br />+------------------------------------------+-------+-----------+<br />| event_name                               | count | latency   |<br />+------------------------------------------+-------+-----------+<br />| stage/sql/checking query cache for query |    16 | 724.37 us |<br />| stage/sql/statistics                     |    16 | 546.92 us |<br />| stage/sql/freeing items                  |    18 | 520.11 us |<br />| stage/sql/init                           |    51 | 466.80 us |<br />...<br />| stage/sql/cleaning up                    |    18 | 11.92 us  |<br />| stage/sql/executing                      |    16 | 6.95 us   |<br />+------------------------------------------+-------+-----------+<br />17 rows in set (9.12 sec)<br /><br />+---------------------------+<br />| LONGEST RUNNING STATEMENT |<br />+---------------------------+<br />| LONGEST RUNNING STATEMENT |<br />+---------------------------+<br />1 row in set (9.16 sec)<br /><br />+-----------+-----------+-----------+-----------+---------------+------------+-----------+<br />| thread_id | exec_time | lock_time | rows_sent | rows_examined | tmp_tables | full_scan |<br />+-----------+-----------+-----------+-----------+---------------+------------+-----------+<br />|    166646 | 618.43 us | 1.00 ms   |         0 |             1 |          0 |         0 |<br />+-----------+-----------+-----------+-----------+---------------+------------+-----------+<br />1 row in set (9.16 sec)<br /><br />// Truncated for clarity...<br />+-----------------------------------------------------------------+<br />| sql_text                                                        |<br />+-----------------------------------------------------------------+<br />| select hibeventhe0_.id as id1382_, hibeventhe0_.createdTime ... |<br />+-----------------------------------------------------------------+<br />1 row in set (9.17 sec)<br /><br />+------------------------------------------+-----------+<br />| event_name                               | latency   |<br />+------------------------------------------+-----------+<br />| stage/sql/init                           | 8.61 us   |<br />| stage/sql/Waiting for query cache lock   | 453.23 us |<br />| stage/sql/init                           | 331.07 ns |<br />| stage/sql/checking query cache for query | 43.04 us  |<br />...<br />| stage/sql/freeing items                  | 30.46 us  |<br />| stage/sql/cleaning up                    | 662.13 ns |<br />+------------------------------------------+-----------+<br />18 rows in set (9.23 sec)<br /><br />+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+<br />| id | select_type | table        | type  | possible_keys | key       | key_len | ref         | rows | Extra |<br />+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+<br />|  1 | SIMPLE      | hibeventhe0_ | const | fixedTime     | fixedTime | 775     | const,const |    1 | NULL  |<br />+----+-------------+--------------+-------+---------------+-----------+---------+-------------+------+-------+<br />1 row in set (9.27 sec)<br /><br />Query OK, 0 rows affected (9.28 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_trace_thread.html" data-mapping-enabled="true"><span>ps_trace_thread</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Dumps all data within Performance Schema for an instrumented thread,<br />to create a DOT formatted graph file. <br /><br />Each resultset returned from the procedure should be used for a complete graph<br /><br />Requires the SUPER privilege for "SET sql_log_bin = 0;".<br /><br />Parameters<br />-----------<br /><br />in_thread_id (BIGINT UNSIGNED):<br />  The thread that you would like a stack trace for<br />in_outfile  (VARCHAR(255)):<br />  The filename the dot file will be written to<br />in_max_runtime (DECIMAL(20,2)):<br />  The maximum time to keep collecting data.<br />  Use NULL to get the default which is 60 seconds.<br />in_interval (DECIMAL(20,2)): <br />  How long to sleep between data collections. <br />  Use NULL to get the default which is 1 second.<br />in_start_fresh (BOOLEAN):<br />  Whether to reset all Performance Schema data before tracing.<br />in_auto_setup (BOOLEAN):<br />  Whether to disable all other threads and enable all consumers/instruments. <br />  This will also reset the settings at the end of the run.<br />in_debug (BOOLEAN):<br />  Whether you would like to include file:lineno in the graph<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_trace_thread(25, CONCAT('/tmp/stack-', REPLACE(NOW(), ' ', '-'), '.dot'), NULL, NULL, TRUE, TRUE, TRUE);<br />+-------------------+<br />| summary           |<br />+-------------------+<br />| Disabled 1 thread |<br />+-------------------+<br />1 row in set (0.00 sec)<br /><br />+---------------------------------------------+<br />| Info                                        |<br />+---------------------------------------------+<br />| Data collection starting for THREAD_ID = 25 |<br />+---------------------------------------------+<br />1 row in set (0.03 sec)<br /><br />+-----------------------------------------------------------+<br />| Info                                                      |<br />+-----------------------------------------------------------+<br />| Stack trace written to /tmp/stack-2014-02-16-21:18:41.dot |<br />+-----------------------------------------------------------+<br />1 row in set (60.07 sec)<br /><br />+-------------------------------------------------------------------+<br />| Convert to PDF                                                    |<br />+-------------------------------------------------------------------+<br />| dot -Tpdf -o /tmp/stack_25.pdf /tmp/stack-2014-02-16-21:18:41.dot |<br />+-------------------------------------------------------------------+<br />1 row in set (60.07 sec)<br /><br />+-------------------------------------------------------------------+<br />| Convert to PNG                                                    |<br />+-------------------------------------------------------------------+<br />| dot -Tpng -o /tmp/stack_25.png /tmp/stack-2014-02-16-21:18:41.dot |<br />+-------------------------------------------------------------------+<br />1 row in set (60.07 sec)<br /><br />+------------------+<br />| summary          |<br />+------------------+<br />| Enabled 1 thread |<br />+------------------+<br />1 row in set (60.32 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\ps_truncate_all_tables.html" data-mapping-enabled="true"><span>ps_truncate_all_tables</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Truncates all summary tables within Performance Schema, <br />resetting all aggregated instrumentation as a snapshot.<br /><br />Parameters<br />-----------<br /><br />in_verbose (BOOLEAN):<br />  Whether to print each TRUNCATE statement before running<br /><br />Example<br />-----------<br /><br />mysql> CALL sys.ps_truncate_all_tables(false);<br />+---------------------+<br />| summary             |<br />+---------------------+<br />| Truncated 44 tables |<br />+---------------------+<br />1 row in set (0.10 sec)<br /><br />Query OK, 0 rows affected (0.10 sec)</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\statement_performance_analyzer.html" data-mapping-enabled="true"><span>statement_performance_analyzer</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Create a report of the statements running on the server.<br /><br />The views are calculated based on the overall and/or delta activity.<br /><br />Requires the SUPER privilege for "SET sql_log_bin = 0;".<br /><br />Parameters<br />-----------<br /><br />in_action (ENUM('snapshot', 'overall', 'delta', 'create_tmp', 'create_table', 'save', 'cleanup')):<br />  The action to take. Supported actions are:<br />    * snapshot      Store a snapshot. The default is to make a snapshot of the current content of<br />                    performance_schema.events_statements_summary_by_digest, but by setting in_table<br />                    this can be overwritten to copy the content of the specified table.<br />                    The snapshot is stored in the sys.tmp_digests temporary table.<br />    * overall       Generate analyzis based on the content specified by in_table. For the overall analyzis,<br />                    in_table can be NOW() to use a fresh snapshot. This will overwrite an existing snapshot.<br />                    Use NULL for in_table to use the existing snapshot. If in_table IS NULL and no snapshot<br />                    exists, a new will be created.<br />                    See also in_views and @sys.statement_performance_analyzer.limit.<br />    * delta         Generate a delta analysis. The delta will be calculated between the reference table in<br />                    in_table and the snapshot. An existing snapshot must exist.<br />                    The action uses the sys.tmp_digests_delta temporary table.<br />                    See also in_views and @sys.statement_performance_analyzer.limit.<br />    * create_table  Create a regular table suitable for storing the snapshot for later use, e.g. for<br />                    calculating deltas.<br />    * create_tmp    Create a temporary table suitable for storing the snapshot for later use, e.g. for<br />                    calculating deltas.<br />    * save          Save the snapshot in the table specified by in_table. The table must exists and have<br />                    the correct structure.<br />                    If no snapshot exists, a new is created.<br />    * cleanup       Remove the temporary tables used for the snapshot and delta.<br /><br />in_table (VARCHAR(129)):<br />  The table argument used for some actions. Use the format 'db1.t1' or 't1' without using any backticks (`)<br />  for quoting. Periods (.) are not supported in the database and table names.<br /><br />  The meaning of the table for each action supporting the argument is:<br /><br />    * snapshot      The snapshot is created based on the specified table. Set to NULL or NOW() to use<br />                    the current content of performance_schema.events_statements_summary_by_digest.<br />    * overall       The table with the content to create the overall analyzis for. The following values<br />                    can be used:<br />                      - A table name - use the content of that table.<br />                      - NOW()        - create a fresh snapshot and overwrite the existing snapshot.<br />                      - NULL         - use the last stored snapshot.<br />    * delta         The table name is mandatory and specified the reference view to compare the currently<br />                    stored snapshot against. If no snapshot exists, a new will be created.<br />    * create_table  The name of the regular table to create.<br />    * create_tmp    The name of the temporary table to create.<br />    * save          The name of the table to save the currently stored snapshot into.<br /><br />in_views (SET ('with_runtimes_in_95th_percentile', 'analysis', 'with_errors_or_warnings',<br />               'with_full_table_scans', 'with_sorting', 'with_temp_tables', 'custom'))<br />  Which views to include:<br /><br />    * with_runtimes_in_95th_percentile  Based on the sys.statements_with_runtimes_in_95th_percentile view<br />    * analysis                          Based on the sys.statement_analysis view<br />    * with_errors_or_warnings           Based on the sys.statements_with_errors_or_warnings view<br />    * with_full_table_scans             Based on the sys.statements_with_full_table_scans view<br />    * with_sorting                      Based on the sys.statements_with_sorting view<br />    * with_temp_tables                  Based on the sys.statements_with_temp_tables view<br />    * custom                            Use a custom view. This view must be specified in @sys.statement_performance_analyzer.view to an existing view or a query<br /><br />Default is to include all except 'custom'.<br /><br /><br />Configuration Options<br />----------------------<br /><br />sys.statement_performance_analyzer.limit<br />  The maximum number of rows to include for the views that does not have a built-in limit (e.g. the 95th percentile view).<br />  If not set the limit is 100.<br /><br />sys.statement_performance_analyzer.view<br />  Used together with the 'custom' view. If the value contains a space, it is considered a query, otherwise it must be<br />  an existing view querying the performance_schema.events_statements_summary_by_digest table. There cannot be any limit<br />  clause including in the query or view definition if @sys.statement_performance_analyzer.limit > 0.<br />  If specifying a view, use the same format as for in_table.<br /><br />sys.debug<br />  Whether to provide debugging output.<br />  Default is 'OFF'. Set to 'ON' to include.<br /><br /><br />Example<br />--------<br /><br />To create a report with the queries in the 95th percentile since last truncate of performance_schema.events_statements_summary_by_digest<br />and the delta for a 1 minute period:<br /><br />   1. Create a temporary table to store the initial snapshot.<br />   2. Create the initial snapshot.<br />   3. Save the initial snapshot in the temporary table.<br />   4. Wait one minute.<br />   5. Create a new snapshot.<br />   6. Perform analyzis based on the new snapshot.<br />   7. Perform analyzis based on the delta between the initial and new snapshots.<br /><br />mysql> CALL sys.statement_performance_analyzer('create_tmp', 'mydb.tmp_digests_ini', NULL);<br />Query OK, 0 rows affected (0.08 sec)<br /><br />mysql> CALL sys.statement_performance_analyzer('snapshot', NULL, NULL);<br />Query OK, 0 rows affected (0.02 sec)<br /><br />mysql> CALL sys.statement_performance_analyzer('save', 'mydb.tmp_digests_ini', NULL);<br />Query OK, 0 rows affected (0.00 sec)<br /><br />mysql> DO SLEEP(60);<br />Query OK, 0 rows affected (1 min 0.00 sec)<br /><br />mysql> CALL sys.statement_performance_analyzer('snapshot', NULL, NULL);<br />Query OK, 0 rows affected (0.02 sec)<br /><br />mysql> CALL sys.statement_performance_analyzer('overall', NULL, 'with_runtimes_in_95th_percentile');<br />+-----------------------------------------+<br />| Next Output                             |<br />+-----------------------------------------+<br />| Queries with Runtime in 95th Percentile |<br />+-----------------------------------------+<br />1 row in set (0.05 sec)<br /><br />...<br /><br />mysql> CALL sys.statement_performance_analyzer('delta', 'mydb.tmp_digests_ini', 'with_runtimes_in_95th_percentile');<br />+-----------------------------------------+<br />| Next Output                             |<br />+-----------------------------------------+<br />| Queries with Runtime in 95th Percentile |<br />+-----------------------------------------+<br />1 row in set (0.03 sec)<br /><br />...<br /><br /><br />To create an overall report of the 95th percentile queries and the top 10 queries with full table scans:<br /><br />mysql> CALL sys.statement_performance_analyzer('snapshot', NULL, NULL);<br />Query OK, 0 rows affected (0.01 sec)<br /><br />mysql> SET @sys.statement_performance_analyzer.limit = 10;<br />Query OK, 0 rows affected (0.00 sec)<br /><br />mysql> CALL sys.statement_performance_analyzer('overall', NULL, 'with_runtimes_in_95th_percentile,with_full_table_scans');<br />+-----------------------------------------+<br />| Next Output                             |<br />+-----------------------------------------+<br />| Queries with Runtime in 95th Percentile |<br />+-----------------------------------------+<br />1 row in set (0.01 sec)<br /><br />...<br /><br />+-------------------------------------+<br />| Next Output                         |<br />+-------------------------------------+<br />| Top 10 Queries with Full Table Scan |<br />+-------------------------------------+<br />1 row in set (0.09 sec)<br /><br />...<br /><br /><br />Use a custom view showing the top 10 query sorted by total execution time refreshing the view every minute using<br />the watch command in Linux.<br /><br />mysql> CREATE OR REPLACE VIEW mydb.my_statements AS<br />    -> SELECT sys.format_statement(DIGEST_TEXT) AS query,<br />    ->        SCHEMA_NAME AS db,<br />    ->        COUNT_STAR AS exec_count,<br />    ->        format_pico_time(SUM_TIMER_WAIT) AS total_latency,<br />    ->        format_pico_time(AVG_TIMER_WAIT) AS avg_latency,<br />    ->        ROUND(IFNULL(SUM_ROWS_SENT / NULLIF(COUNT_STAR, 0), 0)) AS rows_sent_avg,<br />    ->        ROUND(IFNULL(SUM_ROWS_EXAMINED / NULLIF(COUNT_STAR, 0), 0)) AS rows_examined_avg,<br />    ->        ROUND(IFNULL(SUM_ROWS_AFFECTED / NULLIF(COUNT_STAR, 0), 0)) AS rows_affected_avg,<br />    ->        DIGEST AS digest<br />    ->   FROM performance_schema.events_statements_summary_by_digest<br />    -> ORDER BY SUM_TIMER_WAIT DESC;<br />Query OK, 0 rows affected (0.01 sec)<br /><br />mysql> CALL sys.statement_performance_analyzer('create_table', 'mydb.digests_prev', NULL);<br />Query OK, 0 rows affected (0.10 sec)<br /><br />shell$ watch -n 60 "mysql sys --table -e "<br />> SET @sys.statement_performance_analyzer.view = 'mydb.my_statements';<br />> SET @sys.statement_performance_analyzer.limit = 10;<br />> CALL statement_performance_analyzer('snapshot', NULL, NULL);<br />> CALL statement_performance_analyzer('delta', 'mydb.digests_prev', 'custom');<br />> CALL statement_performance_analyzer('save', 'mydb.digests_prev', NULL);<br />> ""<br /><br />Every 60.0s: mysql sys --table -e "                                                                                                   ...  Mon Dec 22 10:58:51 2014<br /><br />+----------------------------------+<br />| Next Output                      |<br />+----------------------------------+<br />| Top 10 Queries Using Custom View |<br />+----------------------------------+<br />+-------------------+-------+------------+---------------+-------------+---------------+-------------------+-------------------+----------------------------------+<br />| query             | db    | exec_count | total_latency | avg_latency | rows_sent_avg | rows_examined_avg | rows_affected_avg | digest                           |<br />+-------------------+-------+------------+---------------+-------------+---------------+-------------------+-------------------+----------------------------------+<br />...</span>
                  </td>
                </tr>
                <tr>
                  <td><a href="../../../../../Servers\Cars.localhost\Databases\sys\Procedures\table_exists.html" data-mapping-enabled="true"><span>table_exists</span></a></td>
                  <td>
                    <span><br />Description<br />-----------<br /><br />Tests whether the table specified in in_db and in_table exists either as a regular<br />table, or as a temporary table. The returned value corresponds to the table that<br />will be used, so if there's both a temporary and a permanent table with the given<br />name, then 'TEMPORARY' will be returned.<br /><br />Parameters<br />-----------<br /><br />in_db (VARCHAR(64)):<br />  The database name to check for the existance of the table in.<br /><br />in_table (VARCHAR(64)):<br />  The name of the table to check the existance of.<br /><br />out_exists ENUM('', 'BASE TABLE', 'VIEW', 'TEMPORARY'):<br />  The return value: whether the table exists. The value is one of:<br />    * ''           - the table does not exist neither as a base table, view, nor temporary table.<br />    * 'BASE TABLE' - the table name exists as a permanent base table table.<br />    * 'VIEW'       - the table name exists as a view.<br />    * 'TEMPORARY'  - the table name exists as a temporary table.<br /><br />Example<br />--------<br /><br />mysql> CREATE DATABASE db1;<br />Query OK, 1 row affected (0.07 sec)<br /><br />mysql> use db1;<br />Database changed<br />mysql> CREATE TABLE t1 (id INT PRIMARY KEY);<br />Query OK, 0 rows affected (0.08 sec)<br /><br />mysql> CREATE TABLE t2 (id INT PRIMARY KEY);<br />Query OK, 0 rows affected (0.08 sec)<br /><br />mysql> CREATE view v_t1 AS SELECT * FROM t1;<br />Query OK, 0 rows affected (0.00 sec)<br /><br />mysql> CREATE TEMPORARY TABLE t1 (id INT PRIMARY KEY);<br />Query OK, 0 rows affected (0.00 sec)<br /><br />mysql> CALL sys.table_exists('db1', 't1', @exists); SELECT @exists;<br />Query OK, 0 rows affected (0.00 sec)<br /><br />+------------+<br />| @exists    |<br />+------------+<br />| TEMPORARY  |<br />+------------+<br />1 row in set (0.00 sec)<br /><br />mysql> CALL sys.table_exists('db1', 't2', @exists); SELECT @exists;<br />Query OK, 0 rows affected (0.00 sec)<br /><br />+------------+<br />| @exists    |<br />+------------+<br />| BASE TABLE |<br />+------------+<br />1 row in set (0.01 sec)<br /><br />mysql> CALL sys.table_exists('db1', 'v_t1', @exists); SELECT @exists;<br />Query OK, 0 rows affected (0.00 sec)<br /><br />+---------+<br />| @exists |<br />+---------+<br />| VIEW    |<br />+---------+<br />1 row in set (0.00 sec)<br /><br />mysql> CALL sys.table_exists('db1', 't3', @exists); SELECT @exists;<br />Query OK, 0 rows affected (0.01 sec)<br /><br />+---------+<br />| @exists |<br />+---------+<br />|         |<br />+---------+<br />1 row in set (0.00 sec)</span>
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="footer">
    <div class="col-xs-4">Author:&nbsp;</div>
    <div class="col-xs-4 align-center">Copyright &#169; All Rights Reserved</div>
    <div class="col-xs-4 align-right">Created:&nbsp;10. 04. 2021</div>
  </div>
</body>
</html>